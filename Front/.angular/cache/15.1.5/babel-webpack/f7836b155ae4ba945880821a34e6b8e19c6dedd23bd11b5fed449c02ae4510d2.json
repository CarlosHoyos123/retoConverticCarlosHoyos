{"ast":null,"code":"import { of, switchMap } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nexport class AuthServicio {\n  constructor(_http, _router) {\n    this._http = _http;\n    this._router = _router;\n    /** Propiedad Autenticación */\n    this._authenticated = false;\n    this.url = 'Auth/';\n    /** Propiedad configuración */\n    this.configSession = 'Usuario';\n  }\n  Login(login) {\n    let body = JSON.stringify(login);\n    const url = `${this.url}user`;\n    return this._http.post(url, body).pipe(switchMap(response => {\n      if (response.estado) {\n        this.session = response.cliente; // Asigna información del token\n        this._authenticated = true; // Indica que usuario es autenticado\n      }\n\n      return of(response); // Return a new observable with the response\n    }));\n  }\n\n  Registry(newUser) {\n    let body = JSON.stringify(newUser);\n    const url = `${this.url}create`;\n    console.log(newUser);\n    return this._http.post(url, body).pipe(switchMap(response => {\n      if (response != null) {\n        //this.session = response.cliente;  // Asigna información del token\n        //this._authenticated = true;     // Indica que usuario es autenticado\n      }\n      return of(response); // Return a new observable with the response\n    }));\n  }\n\n  formsSelects() {\n    //return this.http.get(this.server+'Auth/formConfig');\n    const url = `${this.url}formConfig`;\n    return this._http.get(url);\n  }\n  set session(auth) {\n    localStorage.setItem(this.configSession, JSON.stringify(auth));\n  }\n  get session() {\n    if (localStorage.getItem(this.configSession) === null) {\n      this._router.navigate(['Auth/login']);\n    }\n    const sessionJson = localStorage.getItem(this.configSession);\n    const session = sessionJson !== null ? JSON.parse(sessionJson) : null;\n    return session;\n  }\n  get token() {\n    const sessionJson = localStorage.getItem(this.configSession);\n    const session = sessionJson !== null ? JSON.parse(sessionJson) : null;\n    return session.Token;\n  }\n}\nAuthServicio.ɵfac = function AuthServicio_Factory(t) {\n  return new (t || AuthServicio)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Router));\n};\nAuthServicio.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthServicio,\n  factory: AuthServicio.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AAEA,SAAqBA,EAAE,EAAEC,SAAS,QAAQ,MAAM;;;;AAahD,OAAM,MAAOC,YAAY;EAWrBC,YACYC,KAAiB,EACjBC,OAAe;IADf,UAAK,GAALD,KAAK;IACL,YAAO,GAAPC,OAAO;IAXnB;IACQ,mBAAc,GAAY,KAAK;IAE/B,QAAG,GAAW,OAAO;IAE7B;IACQ,kBAAa,GAAW,SAAS;EAMzC;EAEAC,KAAK,CAACC,KAAY;IAEd,IAAIC,IAAI,GAAGC,IAAI,CAACC,SAAS,CAACH,KAAK,CAAC;IAChC,MAAMI,GAAG,GAAG,GAAG,IAAI,CAACA,GAAG,MAAM;IAE7B,OAAO,IAAI,CAACP,KAAK,CAACQ,IAAI,CAAgBD,GAAG,EAAEH,IAAI,CAAC,CAC3CK,IAAI,CACDZ,SAAS,CAAEa,QAAuB,IAAI;MAClC,IAAIA,QAAQ,CAACC,MAAM,EAAE;QACjB,IAAI,CAACC,OAAO,GAAGF,QAAQ,CAACG,OAAO,CAAC,CAAE;QAClC,IAAI,CAACC,cAAc,GAAG,IAAI,CAAC,CAAK;;;MAEpC,OAAOlB,EAAE,CAACc,QAAQ,CAAC,CAAC,CAAgB;IACxC,CAAC,CAAC,CACL;EACT;;EAEAK,QAAQ,CAACC,OAAqB;IAE1B,IAAIZ,IAAI,GAAGC,IAAI,CAACC,SAAS,CAACU,OAAO,CAAC;IAClC,MAAMT,GAAG,GAAG,GAAG,IAAI,CAACA,GAAG,QAAQ;IAC/BU,OAAO,CAACC,GAAG,CAACF,OAAO,CAAC;IACpB,OAAO,IAAI,CAAChB,KAAK,CAACQ,IAAI,CAAeD,GAAG,EAAEH,IAAI,CAAC,CAC1CK,IAAI,CACDZ,SAAS,CAAEa,QAAsB,IAAI;MACjC,IAAIA,QAAQ,IAAI,IAAI,EAAE;QAClB;QACA;MAAA;MAEJ,OAAOd,EAAE,CAACc,QAAQ,CAAC,CAAC,CAAgB;IACxC,CAAC,CAAC,CACL;EACT;;EAEAS,YAAY;IACR;IACA,MAAMZ,GAAG,GAAG,GAAG,IAAI,CAACA,GAAG,YAAY;IACnC,OAAO,IAAI,CAACP,KAAK,CAACoB,GAAG,CAAMb,GAAG,CAAC;EACnC;EAEA,IAAIK,OAAO,CAACS,IAAkB;IAC1BC,YAAY,CAACC,OAAO,CAAC,IAAI,CAACC,aAAa,EAAEnB,IAAI,CAACC,SAAS,CAACe,IAAI,CAAC,CAAC;EAClE;EAEA,IAAIT,OAAO;IACP,IAAIU,YAAY,CAACG,OAAO,CAAC,IAAI,CAACD,aAAa,CAAC,KAAK,IAAI,EAAE;MACnD,IAAI,CAACvB,OAAO,CAACyB,QAAQ,CAAC,CAAC,YAAY,CAAC,CAAC;;IAEzC,MAAMC,WAAW,GAAGL,YAAY,CAACG,OAAO,CAAC,IAAI,CAACD,aAAa,CAAC;IAC5D,MAAMZ,OAAO,GAAiBe,WAAW,KAAK,IAAI,GAAGtB,IAAI,CAACuB,KAAK,CAACD,WAAW,CAAC,GAAG,IAAI;IACnF,OAAOf,OAAO;EAClB;EAEA,IAAIiB,KAAK;IACL,MAAMF,WAAW,GAAGL,YAAY,CAACG,OAAO,CAAC,IAAI,CAACD,aAAa,CAAC;IAC5D,MAAMZ,OAAO,GAAiBe,WAAW,KAAK,IAAI,GAAGtB,IAAI,CAACuB,KAAK,CAACD,WAAW,CAAC,GAAG,IAAI;IACnF,OAAOf,OAAO,CAACkB,KAAM;EACzB;;AAzEShC,YAAY;mBAAZA,YAAY;AAAA;AAAZA,YAAY;SAAZA,YAAY;EAAAiC,SAAZjC,YAAY;EAAAkC,YAHT;AAAM","names":["of","switchMap","AuthServicio","constructor","_http","_router","Login","login","body","JSON","stringify","url","post","pipe","response","estado","session","cliente","_authenticated","Registry","newUser","console","log","formsSelects","get","auth","localStorage","setItem","configSession","getItem","navigate","sessionJson","parse","token","Token","factory","providedIn"],"sourceRoot":"","sources":["C:\\Users\\chrod\\OneDrive\\Documentos\\RepositoriosConvertic\\reto\\Angular\\FrontEcommerce\\src\\app\\servicios\\auth.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpHeaders } from '@angular/common/http';\r\nimport { Observable, of, switchMap } from 'rxjs';\r\n\r\n/** Interfaces */\r\nimport { Login } from '../interface/login';\r\nimport { RespuestaAuth } from '../interface/respuestaAuth';\r\nimport { Autorizacion } from '../interface/autorizacion';\r\nimport { ClientEntity } from '../interface/clientEntity';\r\nimport { Router } from '@angular/router';\r\n\r\n@Injectable({\r\n    providedIn: 'root',\r\n})\r\n\r\nexport class AuthServicio {\r\n\r\n    /** Propiedad Autenticación */\r\n    private _authenticated: boolean = false;\r\n\r\n    private url: string = 'Auth/';\r\n\r\n    /** Propiedad configuración */\r\n    private configSession: string = 'Usuario';\r\n\r\n\r\n    constructor(\r\n        private _http: HttpClient,\r\n        private _router: Router) {\r\n    }\r\n\r\n    Login(login: Login): Observable<any> {\r\n\r\n        let body = JSON.stringify(login);\r\n        const url = `${this.url}user`;\r\n\r\n        return this._http.post<RespuestaAuth>(url, body)\r\n            .pipe(\r\n                switchMap((response: RespuestaAuth) => {\r\n                    if (response.estado) {\r\n                        this.session = response.cliente;  // Asigna información del token\r\n                        this._authenticated = true;     // Indica que usuario es autenticado\r\n                    }\r\n                    return of(response);                // Return a new observable with the response\r\n                })\r\n            );\r\n    }\r\n\r\n    Registry(newUser: ClientEntity): Observable<any> {\r\n\r\n        let body = JSON.stringify(newUser);\r\n        const url = `${this.url}create`;\r\n        console.log(newUser); \r\n        return this._http.post<ClientEntity>(url, body)\r\n            .pipe(\r\n                switchMap((response: ClientEntity) => {\r\n                    if (response != null) {\r\n                        //this.session = response.cliente;  // Asigna información del token\r\n                        //this._authenticated = true;     // Indica que usuario es autenticado\r\n                    }\r\n                    return of(response);                // Return a new observable with the response\r\n                })\r\n            );\r\n    }\r\n\r\n    formsSelects(): Observable <any>{\r\n        //return this.http.get(this.server+'Auth/formConfig');\r\n        const url = `${this.url}formConfig`;\r\n        return this._http.get<any>(url)\r\n    }\r\n\r\n    set session(auth: Autorizacion) {\r\n        localStorage.setItem(this.configSession, JSON.stringify(auth));\r\n    }\r\n\r\n    get session(): Autorizacion {\r\n        if (localStorage.getItem(this.configSession) === null) {\r\n            this._router.navigate(['Auth/login']);\r\n        }\r\n        const sessionJson = localStorage.getItem(this.configSession);\r\n        const session: Autorizacion = sessionJson !== null ? JSON.parse(sessionJson) : null;\r\n        return session;\r\n    }\r\n\r\n    get token(): string {\r\n        const sessionJson = localStorage.getItem(this.configSession);\r\n        const session: Autorizacion = sessionJson !== null ? JSON.parse(sessionJson) : null;\r\n        return session.Token!;\r\n    }\r\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}